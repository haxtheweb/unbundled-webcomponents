import{DirHelper}from"./vaadin-dir-helper.js";const directionSubscribers=[];let scrollType;new MutationObserver((function(){const documentDir=getDocumentDir();directionSubscribers.forEach(element=>{alignDirs(element,documentDir)})})).observe(document.documentElement,{attributes:!0,attributeFilter:["dir"]});const alignDirs=function(element,documentDir){documentDir?element.setAttribute("dir",documentDir):element.removeAttribute("dir")},getDocumentDir=function(){return document.documentElement.getAttribute("dir")};export const DirMixin=superClass=>class VaadinDirMixin extends superClass{static get properties(){return{dir:{type:String,readOnly:!0}}}static finalize(){super.finalize(),scrollType||(scrollType=DirHelper.detectScrollType())}connectedCallback(){super.connectedCallback(),this.hasAttribute("dir")||(this.__subscribe(),alignDirs(this,getDocumentDir()))}attributeChangedCallback(name,oldValue,newValue){if(super.attributeChangedCallback(name,oldValue,newValue),"dir"!==name)return;const newValueEqlDocDir=newValue===getDocumentDir()&&-1===directionSubscribers.indexOf(this),newValueEmptied=!newValue&&oldValue&&-1===directionSubscribers.indexOf(this),newDiffValue=newValue!==getDocumentDir()&&oldValue===getDocumentDir();newValueEqlDocDir||newValueEmptied?(this.__subscribe(),alignDirs(this,getDocumentDir())):newDiffValue&&this.__subscribe(!1)}disconnectedCallback(){super.disconnectedCallback(),this.__subscribe(!1),this.removeAttribute("dir")}__subscribe(push=!0){push?-1===directionSubscribers.indexOf(this)&&directionSubscribers.push(this):directionSubscribers.indexOf(this)>-1&&directionSubscribers.splice(directionSubscribers.indexOf(this),1)}__getNormalizedScrollLeft(element){return DirHelper.getNormalizedScrollLeft(scrollType,this.getAttribute("dir")||"ltr",element)}__setNormalizedScrollLeft(element,scrollLeft){return DirHelper.setNormalizedScrollLeft(scrollType,this.getAttribute("dir")||"ltr",element,scrollLeft)}};